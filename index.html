<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>학생 일정 관리</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
      background-color: #f4f4f4;
    }
    .student-section {
      border: 1px solid #ccc;
      padding: 20px;
      margin-bottom: 30px;
      background: white;
    }
    h2 {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .category {
      margin-top: 20px;
    }
    .category h3 {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 5px;
    }
    .task {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 10px;
    }
    input, select, button {
      padding: 5px;
      font-size: 1em;
    }
    .view-toggle {
      margin-left: 10px;
    }
    .calendar-view {
      margin-top: 10px;
      background: #e9ecef;
      padding: 10px;
    }
  </style>
</head>
<body>

  <div id="students">
    <!-- 두 명의 학생 반복 생성 -->
    <script>
      const students = ['JH', 'HJ'];
      const categories = [
        { name: '숙제', fields: ['과목:select|영어,수학,과학', '마감일:date'] },
        { name: '공부', fields: ['과목:text|예: 사회', '범위:text|예: 3~5단원', '마감일:date'] },
        { name: '시험', fields: ['과목:text|예: 역사', '범위:text|예: 1~4단원', '마감일:date'] },
        { name: '수행평가', fields: ['내용:text|예: 발표 준비', '마감일:date'] }
      ];

      function generateStudentSection(student) {
        let html = `<div class="student-section" id="student-${student}">
          <h2>
            ${student}
            <span>
              <button onclick="sendToTelegram('${student}')">전송 건</button>
              <select onchange="toggleView(this.value, '${student}')" class="view-toggle">
                <option value="month">월간 보기</option>
                <option value="week">주간 보기</option>
              </select>
            </span>
          </h2>
          <div id="categories-${student}">`;

        categories.forEach(cat => {
          html += `<div class="category" id="${cat.name}-${student}">
            <h3>${cat.name}
              <button onclick="addTask('${student}', '${cat.name}')">+ 추가</button>
            </h3>
            <div class="task-list"></div>
          </div>`;
        });

        html += `</div>
          <div id="calendar-${student}" class="calendar-view">
            [${student}] 월간 또는 주간 달력 보기 영역입니다.
          </div>
        </div>`;
        document.write(html);
      }

      students.forEach(generateStudentSection);
    </script>
  </div>

  <script>
    const categoryFields = {
      '숙제': [
        { label: '과목', type: 'select', options: ['영어', '수학', '과학'] },
        { label: '마감일', type: 'date' }
      ],
      '공부': [
        { label: '과목', type: 'text', placeholder: '예: 사회' },
        { label: '범위', type: 'text', placeholder: '예: 3~5단원' },
        { label: '마감일', type: 'date' }
      ],
      '시험': [
        { label: '과목', type: 'text', placeholder: '예: 역사' },
        { label: '범위', type: 'text', placeholder: '예: 1~4단원' },
        { label: '마감일', type: 'date' }
      ],
      '수행평가': [
        { label: '내용', type: 'text', placeholder: '예: 발표 준비' },
        { label: '마감일', type: 'date' }
      ]
    };

    function addTask(student, category) {
      const taskDiv = document.createElement('div');
      taskDiv.className = 'task';

      categoryFields[category].forEach(field => {
        const label = document.createElement('label');
        label.textContent = field.label + ': ';
        if (field.type === 'select') {
          const select = document.createElement('select');
          field.options.forEach(opt => {
            const option = document.createElement('option');
            option.value = opt;
            option.textContent = opt;
            select.appendChild(option);
          });
          label.appendChild(select);
        } else {
          const input = document.createElement('input');
          input.type = field.type;
          if (field.placeholder) input.placeholder = field.placeholder;
          label.appendChild(input);
        }
        taskDiv.appendChild(label);
      });

      const checkboxLabel = document.createElement('label');
      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.onclick = () => {
        taskDiv.remove(); // 완료되면 항목 삭제
      };
      checkboxLabel.appendChild(checkbox);
      checkboxLabel.append(' 완료');
      taskDiv.appendChild(checkboxLabel);

      document.querySelector(`#${category}-${student} .task-list`).appendChild(taskDiv);
    }

    function sendToTelegram(student) {
      alert(`${student}의 데이터를 텔레그램으로 전송합니다 (여기에 실제 API 연결 가능)`);
    }

    function toggleView(view, student) {
      const calendar = document.getElementById("calendar-" + student);
      calendar.innerText = `[${student}] ${view === 'month' ? '월간' : '주간'} 보기로 전환되었습니다.`;
    }
  </script>

</body>
</html>
